<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GradSystem | Join Us</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
</head>
<body class="bg-slate-50 flex items-center justify-center min-h-screen p-4">

    <div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-2xl border border-slate-100">
        <div class="text-center mb-10">
            <h1 class="text-3xl font-bold text-slate-800">Create Account</h1>
            <p class="text-slate-500 mt-2">Join the next generation of academic grading</p>
        </div>

        <label class="block text-sm font-bold text-slate-700 mb-4 text-center uppercase tracking-wider">I am a...</label>
        <div class="grid grid-cols-2 gap-6 mb-8">
            <div id="studentCard" onclick="selectRegRole('student')" class="cursor-pointer p-6 rounded-2xl border-2 border-blue-600 bg-blue-50 text-center transition-all hover:shadow-lg">
                <div class="text-3xl mb-2">üéì</div>
                <h3 class="font-bold text-blue-700">Student</h3>
            </div>
            <div id="teacherCard" onclick="selectRegRole('teacher')" class="cursor-pointer p-6 rounded-2xl border-2 border-slate-100 text-center transition-all hover:border-blue-200 hover:shadow-lg">
                <div class="text-3xl mb-2">üßë‚Äçüè´</div>
                <h3 class="font-bold text-slate-600">Teacher</h3>
            </div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="md:col-span-2">
                <label class="block text-sm font-semibold text-slate-700 mb-1">Full Name</label>
                <input type="text" id="regName" placeholder="John Doe" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all">
            </div>
            <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Email Address</label>
                <input type="email" id="regEmail" placeholder="john@example.com" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all">
            </div>
            <div>
                <label class="block text-sm font-semibold text-slate-700 mb-1">Password</label>
                <input type="password" id="regPass" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" class="w-full px-4 py-3 border rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition-all">
            </div>
        </div>

        <button onclick="handleRegister()" class="w-full mt-8 bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg shadow-blue-200 transition-all flex items-center justify-center text-lg">
            Create My Account
        </button>

        <p class="text-center text-slate-500 mt-6">
            Already have an account? <a href="index.html" class="text-blue-600 font-bold hover:underline">Sign In</a>
        </p>
        
        <p id="regError" class="text-red-500 text-sm mt-4 text-center hidden"></p>
    </div>

    <script src="config.js"></script>
    <script>
        let selectedRole = 'student';

        function selectRegRole(role) {
            selectedRole = role;
            const sCard = document.getElementById('studentCard');
            const tCard = document.getElementById('teacherCard');

            if (role === 'student') {
                sCard.className = "cursor-pointer p-6 rounded-2xl border-2 border-blue-600 bg-blue-50 text-center transition-all hover:shadow-lg";
                tCard.className = "cursor-pointer p-6 rounded-2xl border-2 border-slate-100 text-center transition-all hover:border-blue-200 hover:shadow-lg";
            } else {
                tCard.className = "cursor-pointer p-6 rounded-2xl border-2 border-blue-600 bg-blue-50 text-center transition-all hover:shadow-lg";
                sCard.className = "cursor-pointer p-6 rounded-2xl border-2 border-slate-100 text-center transition-all hover:border-blue-200 hover:shadow-lg";
            }
        }

        async function handleRegister() {
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPass').value;
            const name = document.getElementById('regName').value;
            const errorMsg = document.getElementById('regError');

            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;

                await db.collection('users').doc(user.uid).set({
                    uid: user.uid,
                    name: name,
                    email: email,
                    role: selectedRole,
                    created_at: firebase.firestore.FieldValue.serverTimestamp()
                });

                window.location.href = `${selectedRole}.html`;
            } catch (error) {
                errorMsg.innerText = error.message;
                errorMsg.classList.remove('hidden');
            }
        }
    </script>
</body>
</html>